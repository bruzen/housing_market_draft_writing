\chapter{Methodology} \label{chapter-methodology}
% TODO Rename file/label as an appendix, or fill out and make into a chapter again
% In addition to the core contribution linking housing and productivity, there are three methodological lines of contribution, and there are policy implications SUMMARIZE METHODOLOGICAL CONTRIBUTIONS %(rent is key to financialization, however the main urban models don't observe the distribution of rents)


% \subsection{Systems design engineering and the systems level effects of financialization}
% Appropriate for systems design engineering
% - engineering is science to responsibility.

\textbf{the french engineers} - method math and back..

econ a kind of reactionary precursor to complex systems.  Adam smith- methodological evolution. ABM and link model.

not an exercise in modelling, it's an exercise in understanding what's happening
want to know what's happening in society and what we can do. why we want to talk about hysteresis and the effects on social classes.

haven't formulated even the theoretical model
rent and social class not in the alonzo model
couldn't track whose in what class when you do your analysis of scaling
large gap but hard to see since not maped, theoretical objects barely formulated.

DISCOVERY PROCESS
An accident that we found this model, looking for someone to have answered this, planned to just use economic theory.

thought the model.. 

- to move with the dynamism of how people think. 

(personal ethnography, co-creation, activist method from australi.)

Simple agent based modes
TO DO THIS -
having done this rockefeller work-- wanted to move between omdels way people thing.

core decsions fast..
get good results and hold core details in their head..

lots of great models out there. 

\textbf{Coarse graining, curse of dimensionality}
flow between these classes of models.

WE DO THIS
Link agent based and analytic models.

conceputally clear modelling traditon not connected to one that lets you look at individual trajectoreis---

- distribution, a farm, unemployed youth. .. - bring in infrastructure from well defined simplified models

abm is in some ways simpler- this agent does this. 
-- get input asking someone questions- this is wha t people knwo - do this as a buyer..---ive assempled these piece..

(we've made it a well formed question by making it a model structure. accepted the conventional knowlege about he large scale dynamics..
formulated the conventional knowleges so it can talk to the input.. )


-wasn't clear why we couldn't get what we needed from econ.
did a bunch of work building a biger model, lots of discusion about the \gls{transmission mechanism}.
We realized it shoudl be coarse grained. 

REPRHASE METHODOLOGICAL CONNTRIBUTIONS FROM INTRO

A MEANS IS USE OF THE 
Constructing an urban \gls{agent-based model} that is consistent with {neoclassical growth theory}. We show how the neoclassical framework can be implemented in the agent-based framework, and make a case for the usefulness of the approach in linking urban rents and productivity. %Chapter~\ref{chapter-methodology} discuses methodological implications of this approach.

THIS HAS IMPLICATIONS
Building a model that is easily extended to explore a range of issues, and used to evaluate policy options. 
The model combines clear and explicit theoretical assumptions with careful and transparent implementation of the logic. % in code.. %flexible Python code.
    % \item Providing a model that we believe
We have taken care to allow for  both theoretical and policy-relevant extensions in the simulation,  building a base model that aims to be as simple as something like Alonzo's urban model \cite{alonsoLocationLandUse1964}, but 
% To be useful in policy discussions, a model must  
simulates the relevant system features and can incorporate a range of intervention types. %way the simulation model is coded. 


IT LETS YOU DO THINGS THAT HAVE BEEN HARD
- e.g. have tractible models that let you explore \textbf{hysteresis, reversibility}- hopefully bringing it towards the core of analysis
Resilience.

DOING THIS IN AN ENGINEERING DEPARTMENT
Engineering  knowledge for responsibility - just like a bridge, a social choice to have a middle class.
have housing for everyone, have food for everyone

social engineering has been a sensitive point- efforts have tended to control.
Particularly after WWII social experiments, that were horors.

even building predictive modes is a problem. any intervention that makes your model predictive increases your control.

Reductionism had some holdouts but largely unchallenged

%Challenges to reductionism deep within the field too

Answer is of course to relinquish commitment to state. 

- syxtems and resilience give  a bridge
What is the systems compenent - design for the properties- 
clearly a system

social engineering- a note on the approach to engineering in social system
cannot know much about state- have to comite to regime, it is then possible to comit to things like freedom..
to autonomy, relinquish comitent to stat


RESILIENCE IS CENTRAL TO THE ADVANCE - TO ACTUALLY MAKING AN ENGINEERING OF THE SOCIAL POSSIBLE.

Repeat from introduction contributions
Note multiple drivers - \textbf{not sensitive to any advantage being true all of the time. etc } IN THE STRUCTURE.
can be thought of as regimes containing tipping points, the feduciary duty of governance is to sustain the regimes society chooses, to make that process of choosing tractibel labs, Kahane.

at the level of capturing and sharing details.

applied work
- development of funds of develoment corporations aligned, of a national network working on a new pattern of development, and larger research programs on housing systems, flows from this relatively simple conceptual core

has to do with Social innovation, how societies are transformed,
gives an ease in relating the model with the action. 

action and choice
weak links in hosting, 

did these models for rockefeller, for the labes-- had a group
worked iwith the games intstitued ith design..



\section{Overview}

ANY OF THIS HERE?
Because of the gap, we had to bring together bunch of pieces, and the way we did that ended up being kind of methodological contribution..
Once we have this model it is useful for also understanding the wealth effects, in particular the resilience dynamics
Resilience is an under used concept in economic analysis for a few reasons. We show an example of that type of analysis based on hysteresis here. 

- a number of themes get in as bonus themes.

% Although many  who employ ABMs to analyse urban systems are deeply skeptical of neoclassical assumptions This demonstrates % in this context how %easily and productively 
 %, linking traditions that have been separate. 
In general, there is relatively little work rigorously linking analytic and agent based models, so the results can be understood formally, in relation. % incorporated into prior traditions and

***
DOC START

In this chapter we discuss the methodological approach of the thesis, as well as a number of modelling decisions. 


We are focused on the evolution of a city. In a city, people and organizations make individual decisions independently, constantly adjusting and shaping the city they inhabit. As a result, cities evolve continuously and and don't reach any final equilibrium. 
%In any city, numerous people and organizations in the city are making individual decisions independently, constantly adjusting in sensible ways to the changing parameters of the city they inhabit. As a result, cities evolve continuously and may never be in equilibrium.  To model this complex, dynamical, multi-agent economic system we  rely on techniques and insights from several fields and we  employ two distinct modeling approaches. We develop and explain the theoretical foundation of our work using a range of results from the economic  literature. We go on to implement the theoretical model in the agent-based modeling (ABM) framework. 
% In doing so we are attentive to the strengths and weaknesses of the approaches that we are adopting. 

\subsection{Equilibrium versus agent-based modeling}

Economists rely heavily on equilibrium analysis in their study of complex systems. 
%In Economic modelling the most familiar approach is the  analysis of systems in equilibrium. 
A set of necessary conditions describing a steady state of interest are imposed and then solved to find features of the equilibrium they generate. It is a productive methodology partly because it  bypasses the complex process of adjustment, focusing on the conditions that must be true if a particular situation is to persist.

The classic example is the ubiquitous supply and demand model. Each curve represents plausible behaviours of a class of agents. A situation is unlikely to persist if either class of agents is unsatisfied with the combination of price and quantity. The model explores the combinations that satisfy the behavoural intentions of both classes i.e. are on both curves. If the two curves can be described mathematically, equilibrium prices and quantities can be derived solving the two-equation system.

The approach produces tractable models that can often be solved explicitly. To achieve tractability, it is often convenient 
to limit the number of independent decision-makers by employing a ``representative agent.'' To extend the analysis to dynamic systems, ``laws of motion'' (adjustment rules) can be added in the form of either difference or differential equations.  Models quickly become intractable with more agents or dynamic 
processes, and economists, like other modellers, resort to simulation 
and numerical methods. 

In an \gls{ABM}, agents are defined as having adjustment rules or behaviours that respond to environmental variables.\footnote{This approach is not unfamiliar to economists - The Cournot duopoly model, for example, is analyzed using `reaction functions' which simply describe a firm's optimal response to as second firm's output choice.} 
Unlike equilibrium approaches, agent-based modelling commits to using computational methods to mimic the distributed decision making of complex systems like cities. A program is written that considers each agent sequentially and updates agent and system statuses as it goes. The program is allowed to iterate, and the values of any state variables of interest are recorded at each step. The model may or may not settle into a steady state. As with other modelling approaches, ABMs can be used explore the behaviour of the system by varying individual parameters, and to explore the parameter space using Monte Carlo methods.

% In ABMs it is often makes sense to simplify models, less for computational reasons then to % The problem of model complexity remains a challenge with ABMs, however, and modellers introduce simplifying assumptions. These are not as a rule needed for the computational model but are helpful in maintaining a focus on the key theme  of the model.  %(ADD distinction between detailed models and detailed explicit models)

We draw heavily on existing economic analysis of cities to identify relevant behaviours and parameters. We also employ three key economic equilibrium conditions drawn from the economic literature: a locational, labour market, and a housing market equilibrium conditions
%Some adjustments are slow and some are fast. Rates of adjustment can matter. 

Because our focus is financialization in the land market, we use the equilibrium conditions for competitive labour markets to bypass the complex and partially understood wage-setting process. We assume, a core theoretical result from the theory of the firm, that workers are paid their \gls{marginal value-product}. We ground this approach in recent research that has derived and estimated an aggregate urban production function consistent with modern \gls{neoclassical growth theory}.\footnote{We are not aware of other research that has taken this step yet.} We use the result to derive an urban wage premium that drives city growth. We would argue that, since housing and labour markets can adjust more quickly than urban productivity, we can assume that they respond  continuously to the slower movement of population and productivity. % need to reference? 

A similar market-based argument allows us to assume that land rents are determined by the classic urban locational equilibrium. The theory is based on the insight that if individual utilities are higher at one location in the city, entrants or movers will choose that  location. This is an implication of consumer choice theory. In a market with any degree of churn market prices for land should converge on use values, and these will vary systematically with transportation costs. For simplicity, we present the model for the case where individuals have the same preferences, employment opportunities and transportation costs. Building on this, %In the computational model 
we can introduce site-specific and person-specific features. 

ALTERNATE PHRASING? Transportation costs depend on distance from the center, so land close to the center is more attractive than land farther away.  The equilibrium concept is that a market with identical individuals with identical incomes and transportation costs will result in identical utilities. The result is that land rent must decline with distance from the central place to offset rising transportation cost. 

Finally, we employ \gls{equilibrium reasoning} in the housing and investment process. We assume investors behave rationally in that they estimate the potential returns on their investments and seek the highest returns they can get. They calculate an offer price in each transaction based on several factors: land rents, expected price changes, their individual price of capital and discounting rate, and the information available to them.

It is at this point we introduce an innovation to formal urban modelling. We draw on the literature for the relevant `\gls{stylized facts}' about differences in these values based on wealth and income. This opens the possibility of urban segregation and the endogenous emergence of \gls{class} distinction based on capital access, a process explored by John Roemer in his neglected General Theory of Exploitation and Class \cite{roemerGeneralTheoryExploitation1982}.  

\Gls{expectations} have to take into account some amount of current and past information. Forecasts based on recent price movements can give rise to \gls{price bubble}s through either speculative or precautionary motives. Expectations anchored in \gls{perfect foresight} have different dynamics, since agents correctly forecast the path of prices \cite{muthRationalExpectationsTheory1961}. We employ backwards-looking expectation formation anchored 
%  This ANCHORING IS INTERESTING, BY THE WAY
to current rental returns, which allows agents to be misled by rapidly rising prices. We derive an investment rule of this sort in Chapter~\ref{chapter-financialization}. 

\subsubsection{SORT - single value frontier - explore reasons}
WHERE TO EXPAND% *** We will explain why  the rent charged to the tenant is locked  to a single value. A few factors - we are looking at the frontiers- the economically justified maximum as a way of linking productivity and extraction formally. - there are many variations and extensions to build on/explore/relax these core assumptions - - want to do this for a few reasons..

(MAYBE ADD THIS? Note: we do not assume equilibrium conditions in the agent model, however our approach is to stay close to the analytic tradition, relaxing assumptions to clarify what drives each results, and connect the work with classical and neo-classical theory..)

\subsection{Overlapping generations}
In our model individuals have a working life, then retire. If they own homes they sell and move to the countryside where housing is cheaper. They are replaced by new entrants from the countryside. New entrants may become buyers or tenants. This is a variant of the \gls{overlapping generations}  model in which savings are passed on to the next generation. In our case homes are passed on, as agents retire and move away. While the model has multiple generations, it is not a `dynastic' model in which the generations are linked by family ties and inheritance matters in individual decision-making. We rely on this simple version because the core issues for us are  the effect of financialization on city productivity, whether the city continues to provide opportunity for newcomers and those without the benefit of generational wealth and the emergence of classes. Introducing a richer family structure would complicate the model but add little to understanding  our  main  issue. 

\subsection{Urban and rural wages}
A modelling device that plays a major role is our use of the \gls{urban wage premium}, the difference between a rural and an urban wage driven by positive \gls{agglomeration effect}s on productivity in the city. It cannot be competed away because transportation costs limit access to the productive centre. The wage premium is a partial measure of the agglomeration effect. It generates the \gls{rent premium} on urban land. In this thesis we want to call attention to the distribution of that rent premium.

To simplify the analysis, we assume that we can partition actual wages between the wage premium,  and all other expenses. The wage premium  is available for accumulation or to be spent on transportation. We assume both urban and non-urban populations  receive a \gls{subsistence wage} which covers  the cost of buildings, food and other living costs and a base cost of land. This analytical device appears in classical models (Malthus, Ricardo, Marx) as a subsistence wage. In most urban models it is described as the cost of agricultural land, or more precisely,  as the opportunity cost of urban land at the margin. We simply extended the technique to combine the opportunity cost of urban labour and land, allowing us to focus on the rents themselves. 


There are advantages and disadvantages to this technique. The motivating advantage is that it lets us isolate the social surplus generate by agglomeration. One disadvantage is that it suppresses many issues that are of interest in other contexts - such as choice of home size and quality. In the computational model it is easy to allow for different building types and more complex housing choice, but in this section we simply  want to make the logic of our model as clear as possible. We foresee adding layers to the computational model that incorporate redevelopment and construction and allow for decisions about scale, type and location. 

Another disadvantage of technique in the analytical version is that it does not allow us to make speculation on  the value of  buildings part visible. It is a problem that is dealt with in the computation model, but we believe the added complexity will not add clarity here. Research (see \cite{mcdonaldWilliamAlonsoRichard2007}) has shown  that the core model is robust to many extension of this sort. 

\subsection{Income, wealth and savings}
\begin{verbatim}\color{red}



savings = 0 # = working_age*savings_rate*psi + savings_rate*(omega-c*d) #second part  only if owner 
            # everyone saves out of subsistence and owners save out of economic rent 
            # lifetime income of owners diverges from rentors even though current income does not. 
            # this matters if they buy  a rental property, otherwise it disappears into current consumption and retirement standard of livineg
            # relationship  between income and consumption is suppressed by forcing a uniform subsistence wage.

QUESTION - SHOULD PART OF THIS DISCUSSION GO IN THE MODEL SECTION?
\end{verbatim}



\subsubsection{Examples of  \gls{equilibrium reasoning} in our analysis}

As an example of \gls{equilibrium reasoning},  we implicitly impose the locational equilibrium condition,
\[U_i(d,\dots)=U_j(d, \dots),\]where $U_i(d,\dots)$ represents agent $i$'s utility at distance $d$. 
The condition says that identical individuals must get the same utility no matter how far they live from the city centre. If that were not the case, individuals would move to a location where they get higher utility. For utility to remain constant as  transportation costs  rise, some other variable must compensate. In this class of models, rent charged for the use of land must fall as distance increases. Equilibrium locational choice by commuters therefore determines the extent and ultimately  population of the city.\footnote{More complex models allow home sizes and lot sizes in the suburbs to increase as well.} Since land value  is \gls{capitalize}d rent, land values also decline toward the edge of the city until they are equal to the rural value of land. 
% different location would take a long time to work through the system. Prices, however, can adjust much more quickly. 

An adjustment process that requires people to move to a different location would take a long time to work through the system. Prices, however, can adjust much more quickly.



%  It follows that 
% \[\frac{\partial U_i(d, d(dots)}{\partial t}=\frac{\partial U_j(d, /dots)}{\partial t}\]

We also rely on equilibrium arguments in our model to ``black box'' the productions sector and most of  the labour market, including most decisions by producers and wage demands by workers. 


\subsubsection{\Gls{marginal} vs \gls{inframarginal} quantities}
In relying on these equilibrium conditions, we are implicitly applying standard neoclassical economic methods despite the fact that our focus is not on the \gls{marginal} conditions that determine prices, but on the \gls{inframarginal} quantities that make up rents. We can illustrate with a diagram that is more fully explained in Chapters~\ref{chapter-rent} and \ref{chapter-space}. 

\begin{figure}[h!t!]
    \centering
 \begin{tikzpicture}[domain=0:2]
%\draw[thick,color=gray,step=.5cm, dashed] (-0.5,-.5) grid (3,3);
\draw[line width=.01] (0,0) -- (10,0) node[right] {$d$};
\node at (1,0) [below,text width=2cm] {center of town};
%\draw[thick ] (0,3)node[above right] {merchant's price in town} -- (10,3) ;
\draw[thick ] (0,0)  -- (10,0); 
\draw[thick, -latex] (6,2.8)
node[right, text width=5cm]{declining equilibrium  home prices and land rent found by requiring that the marginal utility of moving be zero} 
to [out=180, in=45](4.5,2); 

\fill[orange!30] (1.05,0.05)--(8.75,0.05)--(1.05,3.42)--cycle;

\draw[thick, dashed ] (1,0) -- (1,3.8);
\draw[thick ] (9,0)node [above right]{$d^*$}circle[radius=2pt] node[below=.35cm,text width=4cm] {edge of town found by requiring that the marginal utility of moving be zero} -- (1,3.5) ;

\node at (3,1.3){Total Rent};
\end{tikzpicture} 
   \caption{Marginal and infra-marginal quantities}
    \label{fig-land-rent-as-inframarginal}
\end{figure}


In Figure~\ref{fig-land-rent-as-inframarginal}, The level of rent is determined at any distance by individuals making comparison locally. At point $d^*$ the person at the edge of the city decides whether to work in the centre or in the non-urban space. These are \gls{marginal} decisions. The orange area represents  the total rents generated between $d=0$ and $d=d^*$. It is a summation of \textbf{\gls{inframarginal}} rents. Like Ricardo in his classic study \cite{ricardoEssayInfluenceLow1815}, we are concerned with the distribution of rents, which are an  inframaginal quantity.


% providing tractable models.  equilibrium analysis of marginal effects, and representative agents which hid distributional effects, as well as spaceless economic models of markets made it difficult to capture the richer spacial dynamics of urban rents, and the details of the ways economic forces play out for individual actors.

% First they've not tended to build in, in a sophisticated way classical economic theory,
% In general, classical economic theory has not been developed in agent-based modeling work
% Agent-based models have begun with simple models, using and relaxing neoclassical assumptions, and building from first principles. This is absolutely the place to start. As the field matures, it makes sense to introduce theory in a more nuanced way, that connects with classical theory/the history of thought, etc

% Second, relatively little agent-based modelling work integrates with the neoclassical economic work in a way that makes the relation clear/holds the advantages. ABM work tends to both reject neoclassical approaches and rely on neoclassical assumptions.
% More generally only a few agent models (e.g. spruce budworm) connect the analytic and agent models in a clear rigorous way. We focus on holding in addition to the relation with classical theory, a close connection with the many advances made withing neoclassical modelling

% - this connection will make it easier to incorporate in teaching and for mainstream economists to engage on and build with.

% This work builds, first, a simple conceptually clear model tightly integrated with the core economic modelling traditions, that builds on the theory of rent.

% ALSO (Agent modelling also tents to model individuals- we also take some steps to agent-based modelling beyond the individual, and to the work developing model in a mode ideas)

% Third, econ lacks resilience analysis and models, yet hysteresis clearly present in the relation between the built environment and econ activity. Although there's been work on dynamics and individual effects, there has been little work looking at the resilience dynamics in economic models, we take that approach looking at the resilience of community and individual wealth, and the relationship between that wealth and productivity. 

% - This puts resilience dynamics at the center of economic analysis.

% The resilience analysis looks at the dynamics of rent in economic boom and bust cycles.
% There is a ratchet effect, achieved through hysteresis in the system, in which sucks wealth out of communities on the way up and on the way down. % DETAIL ONCE DRAFTED.


% \section{Other notes - to sort}

% % TEMP - here are some other notes we may want to reference or bring in. [[non individualistic modeling of agents]] [[generalizability in agent vs classical econ models]]

% The emphasis is on clarity and connecting with the equilibrium in economics, and systematically relaxing each, to connect with the analytic tradition of economic modelling
% The clarity of intuition of the neoclassical tradition with the deeper root of distribution theory rooted in classical economics and the breath and rigor possible with new tools from the study of complexity and statistical physics.

% Methodological questions: 

%     - agent models (integrating theory more completely into agent models)
    
%     - rent theory

% Core model

%     - static version
    
%     - dynamic version

% Simulations
% Result - hysteresis,
% Policy

